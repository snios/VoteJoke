<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"
             xmlns:b="http://bootsfaces.net/ui"
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:f="http://java.sun.com/jsf/core"
             xmlns:p="http://primefaces.org/ui">


    <b:container>
        <h:form id="jokeform">
            <p:dataGrid var="joke" value="#{voteDarkBean.jokes}" columns="1" layout="grid"
                        rows="8" paginator="true" id="jokes"
                        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                        rowsPerPageTemplate="4,8,16">

                <f:facet name="header">
                    Vote on Dark Jokes
                </f:facet>

                <p:panel header="#{joke.category.description}" style="text-align:center">

                    <f:facet name="header">
                        <h:graphicImage library="images" name="#{joke.category.description}.png" width="50px" height="50px"/>
                    </f:facet>

                    <h:outputText value="#{joke.jokeText}"/>

                    <b:row style="text-align:center">
                        <p:outputLabel value="Rate joke! Current rating: "></p:outputLabel>
                        <h:outputText value="#{joke.avarageRating}" style="font-weight: bold">
                            <f:convertNumber type="number" groupingUsed="true" minFractionDigits="2" pattern="#0.00"/>
                        </h:outputText>
                        <p:rating value="#{joke.ratingValue}" cancel="false" stars="5" style="text-align:center">
                        </p:rating>
                        <b:commandButton look="success" value="Submit vote" style="margin: 0 auto text-align:center" action="#{voteDarkBean.vote}" update="messages jokeform">
                            <f:setPropertyActionListener value="#{joke}" target="#{voteDarkBean.selectedJoke}" />
                        </b:commandButton>
                    </b:row>
                    <br/>
                    <b:row style="text-align:center">
                        <b:column span="2" offset="4">
                            <b:inputText value="#{joke.reportReason}" placeholder="Reason..."></b:inputText>
                        </b:column>
                        <b:column span="2">
                            <b:commandButton look="danger" value="Report Joke" style="margin: 0 auto text-align:center" action="#{voteDarkBean.report}" update="messages jokeform">
                                <f:setPropertyActionListener value="#{joke}" target="#{voteDarkBean.selectedJoke}" />
                            </b:commandButton>
                        </b:column>
                    </b:row>
                    <f:facet name="footer">
                        <h:outputText value="Author: " style="font-style: italic"></h:outputText> <p:outputLabel value="#{joke.author}"></p:outputLabel>
                    </f:facet>
                </p:panel>
            </p:dataGrid>
        </h:form>
    </b:container>

</ui:fragment>